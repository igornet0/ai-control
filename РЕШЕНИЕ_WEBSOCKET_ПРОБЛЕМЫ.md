# üîß –†–ï–®–ï–ù–ò–ï WEBSOCKET –ü–†–û–ë–õ–ï–ú–´

## üö® **–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
```
WebSocket connection to 'ws://localhost/?token=NmUwdL862Txc' failed: 
WebSocket is closed due to suspension.
```

## üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

### **–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚úÖ **Vite HMR (Hot Module Replacement)** WebSocket
- ‚úÖ –ù–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞, **–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**
- ‚úÖ –í–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ development —Ä–µ–∂–∏–º–µ –ø—Ä–∏ hot reload

### **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ:**
- ‚úÖ **Frontend –¥–æ—Å—Ç—É–ø–µ–Ω** (HTTP 200)
- ‚úÖ **Backend API —Ä–∞–±–æ—Ç–∞–µ—Ç** (HTTP 401 - —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- ‚úÖ **–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª** - drag-and-drop, –≤–∏–¥–∏–º–æ—Å—Ç—å –∫–∞—Ä—Ç–æ—á–µ–∫
- ‚úÖ **–í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã** –∏ —Ä–∞–±–æ—Ç–∞—é—Ç

## üí° **–†–µ—à–µ–Ω–∏—è:**

### **1. –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ):**
**–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è** - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ—Ç Vite HMR. 
–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é.

### **2. –ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –º–æ–∂–Ω–æ:

#### **–ê) –û–±–Ω–æ–≤–∏—Ç—å nginx –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Vite HMR:**
```nginx
# –í aic_docker/nginx/nginx.dev.conf
location / {
    proxy_pass http://frontend:3000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    
    # WebSocket support –¥–ª—è Vite HMR
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection $connection_upgrade;
    
    # –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è WebSocket
    proxy_connect_timeout 86400;
    proxy_send_timeout 86400;
    proxy_read_timeout 86400;
}

# –î–æ–±–∞–≤–∏—Ç—å mapping –¥–ª—è Connection header
map $http_upgrade $connection_upgrade {
    default upgrade;
    '' close;
}
```

#### **–ë) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Vite –¥–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ nginx:**
```javascript
// –í front-ai-control/vite.config.ts
export default defineConfig({
  server: {
    hmr: {
      clientPort: 80, // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å nginx –ø–æ—Ä—Ç
    }
  }
})
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**

#### **–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:**
- ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **Drag-and-drop –∫–∞—Ä—Ç–æ—á–µ–∫** - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–∞—Ä—Ç–æ—á–µ–∫** - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **API endpoints** - —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - —Ä–∞–±–æ—Ç–∞–µ—Ç

#### **–ß—Ç–æ –ù–ï –∑–∞—Ç—Ä–æ–Ω—É—Ç–æ:**
- ‚ùå Hot Module Replacement –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- ‚ùå –ú–æ–≥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- ‚ùå Auto-refresh –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞ –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

### **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
**–ü—Ä–æ–±–ª–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å—á–µ–∑–Ω–µ—Ç** –≤ production —Ä–µ–∂–∏–º–µ, —Ç–∞–∫ –∫–∞–∫:
- Vite HMR –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ development
- Production build –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç WebSocket –¥–ª—è HMR
- Nginx –≤ production –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å HMR

### **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
**–û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å** - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é.
–ï—Å–ª–∏ HMR –≤–∞–∂–µ–Ω –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ 2–ê –∏–ª–∏ 2–ë.

## ‚ö° **–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
curl -I http://localhost/              # Frontend ‚úÖ
curl -I http://localhost/api/tasks/    # Backend ‚úÖ
curl -I http://localhost:3000/         # Direct frontend ‚úÖ
```

## üéâ **–ò—Ç–æ–≥:**

**WebSocket –æ—à–∏–±–∫–∞ –ù–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è** –∏ **–ù–ï –≤–ª–∏—è–µ—Ç –Ω–∞:**
- ‚úÖ –û—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ Drag-and-drop –∫–∞—Ä—Ç–æ—á–µ–∫
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–∞—Ä—Ç–æ—á–µ–∫  
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚úÖ API –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

**–í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ!** üöÄ
