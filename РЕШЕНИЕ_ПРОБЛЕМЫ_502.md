# ‚úÖ –†–ï–®–ï–ù–ê –ü–†–û–ë–õ–ï–ú–ê 502 Bad Gateway

## üêõ **–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
–ü—Ä–∏ –∑–∞—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–û–±–∑–æ—Ä" –≤–æ–∑–Ω–∏–∫–∞–ª–∏ –æ—à–∏–±–∫–∏ 502 Bad Gateway –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ API endpoints:
- `/api/tasks/`
- `/api/projects/`
- `/api/personal-dashboard/overview-layout`

## üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

### 1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:**
```bash
docker ps  # –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
```

### 2. **–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ backend:**
```bash
docker logs ai-control-backend-dev
# –ü–æ–∫–∞–∑–∞–ª: AMQPConnectionError: [Errno 111] Connection refused
```

### 3. **–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ nginx:**
```bash
docker logs ai-control-nginx-dev
# –ü–æ–∫–∞–∑–∞–ª: connect() failed (113: Host is unreachable) while connecting to upstream
# upstream: "http://172.18.0.7:8000/api/tasks/"
```

### 4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏:**
```bash
docker network inspect aic_docker_ai-control-network
# Backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: 172.18.0.5, nginx –ø—ã—Ç–∞–ª—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ 172.18.0.7
```

## üîß **–ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

### **–ü—Ä–∏—á–∏–Ω–∞ 1: –ü—Ä–æ–±–ª–µ–º–∞ —Å RabbitMQ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º**
- Backend –Ω–µ –º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ RabbitMQ
- –ó–∞–¥–µ—Ä–∂–∫–∞ `sleep 5` –±—ã–ª–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ RabbitMQ

### **–ü—Ä–∏—á–∏–Ω–∞ 2: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ DNS –≤ nginx**
- nginx –∫—ç—à–∏—Ä–æ–≤–∞–ª —Å—Ç–∞—Ä—ã–µ IP –∞–¥—Ä–µ—Å–∞ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ IP –∞–¥—Ä–µ—Å–∞ –º–µ–Ω—è–ª–∏—Å—å, –Ω–æ nginx –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Å—Ç–∞—Ä—ã–µ

## ‚úÖ **–†–µ—à–µ–Ω–∏—è:**

### **1. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –∑–∞–ø—É—Å–∫–∞ backend:**
```yaml
# aic_docker/docker-compose.dev.yml
command: sh -c "sleep 15 && uvicorn backend.main:app --host 0.0.0.0 --port 8000 --reload"
```
**–ë—ã–ª–æ:** `sleep 5` ‚Üí **–°—Ç–∞–ª–æ:** `sleep 15`

### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ DNS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ nginx:**
```nginx
# aic_docker/nginx/nginx.dev.conf
http {
    # DNS resolver for dynamic service discovery
    resolver 127.0.0.11 valid=10s;
    
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    
    location /api/ {
        set $backend_upstream backend:8000;
        proxy_pass http://$backend_upstream;
        # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    }
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω DNS resolver –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏–º–µ–Ω
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö upstream –¥–ª—è backend
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ –≤—Å–µ–º endpoint'–∞–º (`/api/`, `/static/`, `/media/`)

## üß™ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```bash
curl -X GET "http://localhost/api/tasks/" -I
# HTTP/1.1 502 Bad Gateway
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```bash
curl -X GET "http://localhost/api/tasks/" -I
# HTTP/1.1 401 Unauthorized
```

**‚úÖ 401 Unauthorized - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç!** –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
- nginx —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ backend
- backend —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã
- 401 - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ API

## üéØ **–°—Ç–∞—Ç—É—Å –ø—Ä–æ–±–ª–µ–º—ã:**
üü¢ **–ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–ê**

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:**
1. ‚úÖ –í—Å–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
2. ‚úÖ Backend —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ RabbitMQ
3. ‚úÖ nginx –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ backend
4. ‚úÖ API endpoints –¥–æ—Å—Ç—É–ø–Ω—ã (–æ—Ç–≤–µ—á–∞—é—Ç 401 –≤–º–µ—Å—Ç–æ 502)
5. ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–û–±–∑–æ—Ä" –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
6. ‚úÖ Drag and Drop —Ñ—É–Ω–∫—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å

## üìã **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**

### **1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç:**
```
http://localhost:3000
```

### **2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É:**
- –õ–æ–≥–∏–Ω: `rvevau`
- –ü–∞—Ä–æ–ª—å: `rvevau`

### **3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–û–±–∑–æ—Ä"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ 502
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ drag and drop —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### **4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:**
- –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ 502 Bad Gateway
- –ú–æ–≥—É—Ç –±—ã—Ç—å –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –¥–∞–Ω–Ω—ã–µ), –Ω–æ –Ω–µ 502

## üõ†Ô∏è **–ò–∑–º–µ–Ω–µ–Ω—ã —Ñ–∞–π–ª—ã:**
1. ‚úÖ `aic_docker/docker-compose.dev.yml` - —É–≤–µ–ª–∏—á–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—É—Å–∫–∞ backend
2. ‚úÖ `aic_docker/nginx/nginx.dev.conf` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π DNS resolver

---

**üéâ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞! –°–∞–π—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.**
