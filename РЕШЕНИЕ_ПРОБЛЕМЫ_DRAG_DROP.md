# ‚úÖ –†–ï–®–ï–ù–ê –ü–†–û–ë–õ–ï–ú–ê —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è layout –∫–∞—Ä—Ç–æ—á–µ–∫ –ø—Ä–∏ Drag and Drop

## üêõ **–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
–ü—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–û–±–∑–æ—Ä" –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ 500 Internal Server Error –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫.

**–û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö:**
```
Error updating overview layout: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.StringDataRightTruncationError'>: value too long for type character varying(20)
```

## üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã:**

### **1. –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–∫–∏:**
- GET –∑–∞–ø—Ä–æ—Å—ã –∫ `/api/personal-dashboard/overview-layout` —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- POST –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ –æ—à–∏–±–∫—É 500
- –û—à–∏–±–∫–∞: `StringDataRightTruncationError: value too long for type character varying(20)`

### **2. –ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏:**
–í –º–æ–¥–µ–ª–∏ `UserPreference` –ø–æ–ª–µ `dashboard_layout` –±—ã–ª–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –∫–∞–∫:
```python
dashboard_layout: Mapped[str] = mapped_column(String(20), default="grid")
```

–ù–æ –º—ã –ø—ã—Ç–∞–ª–∏—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å JSON —Å—Ç—Ä–æ–∫—É –¥–ª–∏–Ω–æ–π ~300+ —Å–∏–º–≤–æ–ª–æ–≤:
```json
{
  "overview_cards": {
    "priorities": {"position": 1, "visible": true},
    "overdue": {"position": 0, "visible": true},
    "upcoming": {"position": 2, "visible": true},
    "projects": {"position": 3, "visible": true},
    "notes": {"position": 4, "visible": true},
    "checklist": {"position": 5, "visible": true},
    "time-management": {"position": 6, "visible": true}
  }
}
```

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ:**

### **1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:**
```python
# –ë—ã–ª–æ:
dashboard_layout: Mapped[str] = mapped_column(String(20), default="grid")

# –°—Ç–∞–ª–æ:
dashboard_layout: Mapped[Optional[str]] = mapped_column(Text, nullable=True)
```

### **2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```sql
-- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–æ–ª—è
ALTER TABLE user_preferences ALTER COLUMN dashboard_layout TYPE TEXT;

-- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ NULL –∑–Ω–∞—á–µ–Ω–∏–π  
ALTER TABLE user_preferences ALTER COLUMN dashboard_layout DROP NOT NULL;
```

### **3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend:**
```bash
docker-compose -f aic_docker/docker-compose.dev.yml restart backend
```

## üß™ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```bash
POST /api/personal-dashboard/overview-layout
# HTTP/1.1 500 Internal Server Error
# {detail: "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ layout –∫–∞—Ä—Ç–æ—á–µ–∫"}
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```bash
POST /api/personal-dashboard/overview-layout
# HTTP/1.1 200 OK
# Layout —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
```

## üéØ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:**

### **1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–û–±–∑–æ—Ä":**
```
http://localhost:3000/overview
```

### **2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å:**
- –õ–æ–≥–∏–Ω: `rvevau`
- –ü–∞—Ä–æ–ª—å: `rvevau`

### **3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ Drag and Drop:**
- ‚úÖ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ª—é–±—É—é –∫–∞—Ä—Ç–æ—á–∫—É
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ..."
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!"
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É - layout –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è

### **4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:**
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ 500 –ø—Ä–∏ POST –∑–∞–ø—Ä–æ—Å–∞—Ö
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã API

## üìã **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**

### **1. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö:**
‚úÖ `core/database/models/personal_dashboard_model.py`
- –ò–∑–º–µ–Ω–µ–Ω —Ç–∏–ø –ø–æ–ª—è `dashboard_layout` —Å `String(20)` –Ω–∞ `Text`
- –°–¥–µ–ª–∞–Ω–æ –ø–æ–ª–µ nullable

### **2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
‚úÖ –°—Ö–µ–º–∞ PostgreSQL –æ–±–Ω–æ–≤–ª–µ–Ω–∞:
- –ü–æ–ª–µ `user_preferences.dashboard_layout` —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç —Ç–∏–ø `TEXT`
- –ü–æ–ª–µ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å NULL –∑–Ω–∞—á–µ–Ω–∏—è

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**

### **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
- **–°—Ç–∞—Ä–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: 20 —Å–∏–º–≤–æ–ª–æ–≤ (VARCHAR(20))
- **–ù–æ–≤–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑–ª–∏–º–∏—Ç–Ω–æ (TEXT)
- **–†–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä JSON**: ~300-500 —Å–∏–º–≤–æ–ª–æ–≤

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
```json
{
  "overview_cards": {
    "priorities": {"position": 0, "visible": true},
    "overdue": {"position": 1, "visible": true},
    "upcoming": {"position": 2, "visible": true},
    "projects": {"position": 3, "visible": true},
    "notes": {"position": 4, "visible": true},
    "checklist": {"position": 5, "visible": true},
    "time-management": {"position": 6, "visible": true}
  }
}
```

## üéâ **–°—Ç–∞—Ç—É—Å –ø—Ä–æ–±–ª–µ–º—ã:**
üü¢ **–ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–ê**

### **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ Drag and Drop –∫–∞—Ä—Ç–æ—á–µ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Layout –∫–∞—Ä—Ç–æ—á–µ–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π layout –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ—à–∏–±–∫–∏ 500 –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

---

**üéâ –§—É–Ω–∫—Ü–∏—è drag and drop –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–û–±–∑–æ—Ä" —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞!**
